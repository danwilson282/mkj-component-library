import{$ as Q,b as X,a as Z,c as k,d as ee,e as ae,u as te,C as ne}from"./chunk-MNZWV6CN-COdizNvg.js";import{r as u,j as T}from"./iframe-D8dPSlhY.js";import{f as re}from"./chunk-RJKRL3AU-CzlZidxD.js";import{$ as F}from"./useEvent-Bz-VwyyX.js";import{m as O,l as le,n as se,j as L,p as ie,t as oe}from"./useDateFormatter-B__8B7wY.js";import{$ as ce}from"./useControlledState-D8eDkNBN.js";import{$ as ue}from"./createCalendar-DwJDQY_-.js";import{c as de,b as fe}from"./index-9NAC_5dS.js";import{C as be}from"./chunk-PEV3D27N-Cb7GOZ5t.js";import{f as ve}from"./chunk-YFAKJTDR-_llI_GAI.js";function ge(a,e,r){let s=Q(a,e),o=u.useRef(!1),m=u.useRef(typeof window<"u"?window:null);return F(m,"pointerdown",l=>{o.current=l.width===0&&l.height===0}),F(m,"pointerup",l=>{if(o.current){o.current=!1;return}if(e.setDragging(!1),!e.anchorDate)return;let d=l.target;r.current&&r.current.contains(document.activeElement)&&(!r.current.contains(d)||!d.closest('button, [role="button"]'))&&e.selectFocusedDate()}),s.calendarProps.onBlur=l=>{r.current&&(!l.relatedTarget||!r.current.contains(l.relatedTarget))&&e.anchorDate&&e.selectFocusedDate()},F(r,"touchmove",l=>{e.isDragging&&l.preventDefault()},{passive:!1,capture:!0}),s}function $e(a){let{value:e,defaultValue:r,onChange:s,createCalendar:o,locale:m,visibleDuration:$={months:1},minValue:l,maxValue:d,...E}=a,[t,B]=ce(e,r||null,s),[c,M]=u.useState(null),y="center";if(t&&t.start&&t.end){let b=X(O(t.start),$,m,l,d).add($).subtract({days:1});t.end.compare(b)>0&&(y="start")}let g=u.useRef(null),[f,P]=u.useState(null),R=u.useMemo(()=>le(l,f?.start),[l,f]),S=u.useMemo(()=>se(d,f?.end),[d,f]),i=Z({...E,value:t&&t.start,createCalendar:o,locale:m,visibleDuration:$,minValue:R,maxValue:S,selectionAlignment:a.selectionAlignment||y}),w=n=>{if(n&&a.isDateUnavailable&&!a.allowsNonContiguousRanges){const b=Y(n,i,-1),v=Y(n,i,1);g.current={start:b,end:v},P(g.current)}else g.current=null,P(null)},[V,I]=u.useState(i.visibleRange);(!L(i.visibleRange.start,V.start)||!L(i.visibleRange.end,V.end))&&(w(c),I(i.visibleRange));let p=n=>{n?(M(n),w(n)):(M(null),w(null))},h=c?N(c,i.focusedDate):t&&N(t.start,t.end),U=n=>{if(a.isReadOnly)return;const b=ee(n,R,S),v=ae(b,i.visibleRange.start,a.isDateUnavailable);if(v)if(!c)p(v);else{let A=N(c,v);A&&B({start:W(A.start,t?.start),end:W(A.end,t?.end)}),p(null)}},[_,D]=u.useState(!1),{isDateUnavailable:C}=a,j=u.useMemo(()=>!t||c?!1:C&&(C(t.start)||C(t.end))?!0:k(t.start,l,d)||k(t.end,l,d),[C,t,c,l,d]),x=a.isInvalid||a.validationState==="invalid"||j;return{...i,value:t,setValue:B,anchorDate:c,setAnchorDate:p,highlightedRange:h,validationState:x?"invalid":null,isValueInvalid:x,selectFocusedDate(){U(i.focusedDate)},selectDate:U,highlightDate(n){c&&i.setFocusedDate(n)},isSelected(n){return!!(h&&n.compare(h.start)>=0&&n.compare(h.end)<=0&&!i.isCellDisabled(n)&&!i.isCellUnavailable(n))},isInvalid(n){var b,v;return i.isInvalid(n)||k(n,(b=g.current)===null||b===void 0?void 0:b.start,(v=g.current)===null||v===void 0?void 0:v.end)},isDragging:_,setDragging:D}}function N(a,e){return!a||!e?null:(e.compare(a)<0&&([a,e]=[e,a]),{start:O(a),end:O(e)})}function W(a,e){return a=ie(a,e?.calendar||new oe),e&&"hour"in e?e.set(a):a}function Y(a,e,r){let s=a.add({days:r});for(;(r<0?s.compare(e.visibleRange.start)>=0:s.compare(e.visibleRange.end)<=0)&&!e.isCellUnavailable(s);)s=s.add({days:r});if(e.isCellUnavailable(s))return s.add({days:-r})}function me({buttonPickerProps:a,className:e,...r}){const{Component:s,slots:o,children:m,domRef:$,locale:l,showHelper:d,firstDayOfWeek:E,minValue:t,maxValue:B,weekdayStyle:c,visibleDuration:M,shouldFilterDOMProps:y,isHeaderExpanded:g,visibleMonths:f,disableAnimation:P,createCalendar:R,showMonthAndYearPickers:S,baseProps:i,getPrevButtonProps:w,getNextButtonProps:V,getErrorMessageProps:I,setIsHeaderExpanded:p,topContent:h,bottomContent:U,errorMessage:_,classNames:D,otherProps:C}=te({...r,isRange:!0}),j=u.useRef(null),x=$e({...r,locale:l,minValue:t,maxValue:B,visibleDuration:M,createCalendar:!R||typeof R!="function"?ue:R}),{title:H,calendarProps:n,prevButtonProps:b,nextButtonProps:v,errorMessageProps:A}=ge(r,x,$),q=de(D?.base,e),z={...a,onPress:fe(a?.onPress,()=>p(!g))},G=(K={})=>({...i,Component:s,showHelper:d,firstDayOfWeek:E,topContent:h,bottomContent:U,buttonPickerProps:z,calendarRef:$,calendarProps:n,prevButtonProps:w(b),nextButtonProps:V(v),errorMessageProps:I(A),className:o.base({class:q}),errorMessage:_,...re(C,{enabled:y}),...K}),J=u.useMemo(()=>({state:x,slots:o,headerRef:j,weekdayStyle:c,isHeaderExpanded:g,setIsHeaderExpanded:p,visibleMonths:f,showMonthAndYearPickers:S,classNames:D,disableAnimation:P}),[x,o,D,c,g,p,f,P,S]);return{Component:s,children:m,domRef:$,context:J,state:x,slots:o,title:H,classNames:D,getBaseCalendarProps:G}}var pe=ve(function(e,r){const{context:s,getBaseCalendarProps:o}=me({...e,ref:r});return T.jsx(be,{value:s,children:T.jsx(ne,{...o()})})}),Me=pe;export{Me as r};
