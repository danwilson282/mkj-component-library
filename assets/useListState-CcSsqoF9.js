import{a as $,b as x,c as m}from"./SelectionManager-CI14lW-F.js";import{r as K}from"./iframe-D8dPSlhY.js";class k{*[Symbol.iterator](){yield*this.iterable}get size(){return this._size}getKeys(){return this.keyMap.keys()}getKeyBefore(t){let e=this.keyMap.get(t);var l;return e&&(l=e.prevKey)!==null&&l!==void 0?l:null}getKeyAfter(t){let e=this.keyMap.get(t);var l;return e&&(l=e.nextKey)!==null&&l!==void 0?l:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(t){var e;return(e=this.keyMap.get(t))!==null&&e!==void 0?e:null}at(t){const e=[...this.getKeys()];return this.getItem(e[t])}getChildren(t){let e=this.keyMap.get(t);return e?.childNodes||[]}constructor(t){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=t;let e=i=>{if(this.keyMap.set(i.key,i),i.childNodes&&i.type==="section")for(let n of i.childNodes)e(n)};for(let i of t)e(i);let l=null,v=0,a=0;for(let[i,n]of this.keyMap)l?(l.nextKey=i,n.prevKey=l.key):(this.firstKey=i,n.prevKey=void 0),n.type==="item"&&(n.index=v++),(n.type==="section"||n.type==="item")&&a++,l=n,l.nextKey=void 0;this._size=a;var d;this.lastKey=(d=l?.key)!==null&&d!==void 0?d:null}}function z(s){let{filter:t,layoutDelegate:e}=s,l=$(s),v=K.useMemo(()=>s.disabledKeys?new Set(s.disabledKeys):new Set,[s.disabledKeys]),a=K.useCallback(c=>t?new k(t(c)):new k(c),[t]),d=K.useMemo(()=>({suppressTextValueWarning:s.suppressTextValueWarning}),[s.suppressTextValueWarning]),i=x(s,a,d),n=K.useMemo(()=>new m(i,l,{layoutDelegate:e}),[i,l,e]);return M(i,n),{collection:i,disabledKeys:v,selectionManager:n}}function M(s,t){const e=K.useRef(null);K.useEffect(()=>{if(t.focusedKey!=null&&!s.getItem(t.focusedKey)&&e.current){const u=e.current.getItem(t.focusedKey),h=[...e.current.getKeys()].map(f=>{const o=e.current.getItem(f);return o?.type==="item"?o:null}).filter(f=>f!==null),r=[...s.getKeys()].map(f=>{const o=s.getItem(f);return o?.type==="item"?o:null}).filter(f=>f!==null);var l,v;const p=((l=h?.length)!==null&&l!==void 0?l:0)-((v=r?.length)!==null&&v!==void 0?v:0);var a,d,i;let y=Math.min(p>1?Math.max(((a=u?.index)!==null&&a!==void 0?a:0)-p+1,0):(d=u?.index)!==null&&d!==void 0?d:0,((i=r?.length)!==null&&i!==void 0?i:0)-1),g=null,b=!1;for(;y>=0;){if(!t.isDisabled(r[y].key)){g=r[y];break}if(y<r.length-1&&!b)y++;else{b=!0;var n,c;y>((n=u?.index)!==null&&n!==void 0?n:0)&&(y=(c=u?.index)!==null&&c!==void 0?c:0),y--}}t.setFocusedKey(g?g.key:null)}e.current=s},[s,t])}export{k as $,z as a};
