import{r as s,j as m,s as h}from"./iframe-D8dPSlhY.js";import{u as x,L as c}from"./PresenceContext-CgaSYtSC.js";import{f as C,M as y}from"./index-T4-e1-NW.js";import{t as R}from"./proxy-Bgpb2205.js";const b=new Set(["opacity","clipPath","filter","transform"]),L=s.createContext(null);function E(){const e=s.useRef(!1);return x(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function M(){const e=E(),[t,o]=s.useState(0),r=s.useCallback(()=>{e.current&&o(t+1)},[t]);return[s.useCallback(()=>C.postRender(r),[r]),t]}const G=e=>!e.isLayoutDirty&&e.willUpdate(!1);function d(){const e=new Set,t=new WeakMap,o=()=>e.forEach(G);return{add:r=>{e.add(r),t.set(r,r.addEventListener("willUpdate",o))},remove:r=>{e.delete(r);const n=t.get(r);n&&(n(),t.delete(r)),o()},dirty:o}}const i=e=>e===!0,g=e=>i(e===!0)||e==="id",W=({children:e,id:t,inherit:o=!0})=>{const r=s.useContext(c),n=s.useContext(L),[l,f]=M(),u=s.useRef(null),a=r.id||n;u.current===null&&(g(o)&&a&&(t=t?a+"-"+t:a),u.current={id:t,group:i(o)&&r.group||d()});const p=s.useMemo(()=>({...u.current,forceRender:l}),[f]);return m.jsx(c.Provider,{value:p,children:e})};class w extends y{constructor(){super(...arguments),this.isEnabled=!1}add(t){(R.has(t)||b.has(t))&&(this.isEnabled=!0,this.update())}update(){this.set(this.isEnabled?"transform":"auto")}}function j(){return h(()=>new w("auto"))}export{L as D,W as L,w as W,M as a,b,j as u};
