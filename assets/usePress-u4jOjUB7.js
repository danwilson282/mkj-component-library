import{a as w,g as oe,h as le,f as $,c as v,i as fe,d as z}from"./utils-U1MD0fLI.js";import{$ as ce}from"./runAfterTransition-BqV_gka4.js";import{k as ee,r as k,i as ue,l as j,h as de}from"./iframe-D8dPSlhY.js";import{$ as pe}from"./context-DgExkpuw.js";import{$ as ve}from"./chain-Cz8Y3ew1.js";import{$ as te}from"./mergeProps-BSYFvk6G.js";import{a as $e}from"./useFocusWithin-BGfq9Bt7.js";import{$ as ge}from"./useSyncRef-D5EsUszh.js";import{b as ye,c as be}from"./useFocusVisible-C8HhheBG.js";import{a as m}from"./useEffectEvent-jkaMIIQr.js";function Pe(t,s){if(s.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Te(t,s,a){Pe(t,s),s.set(t,a)}let K="default",Y="",D=new WeakMap;function me(t){if(ee()){if(K==="default"){const s=w(t);Y=s.documentElement.style.webkitUserSelect,s.documentElement.style.webkitUserSelect="none"}K="disabled"}else if(t instanceof HTMLElement||t instanceof SVGElement){let s="userSelect"in t.style?"userSelect":"webkitUserSelect";D.set(t,t.style[s]),t.style[s]="none"}}function N(t){if(ee()){if(K!=="disabled")return;K="restoring",setTimeout(()=>{ce(()=>{if(K==="restoring"){const s=w(t);s.documentElement.style.webkitUserSelect==="none"&&(s.documentElement.style.webkitUserSelect=Y||""),Y="",K="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&D.has(t)){let s=D.get(t),a="userSelect"in t.style?"userSelect":"webkitUserSelect";t.style[a]==="none"&&(t.style[a]=s),t.getAttribute("style")===""&&t.removeAttribute("style"),D.delete(t)}}function Ee(t,s){return s.get?s.get.call(t):s.value}function re(t,s,a){if(!s.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return s.get(t)}function he(t,s){var a=re(t,s,"get");return Ee(t,a)}function Se(t,s,a){if(s.set)s.set.call(t,a);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=a}}function W(t,s,a){var o=re(t,s,"set");return Se(t,o,a),a}function xe(t){let s=k.useContext(pe);if(s){let{register:a,...o}=s;t=te(o,t),a()}return ge(s,t.ref),t}var L=new WeakMap;class O{continuePropagation(){W(this,L,!1)}get shouldStopPropagation(){return he(this,L)}constructor(s,a,o,u){Te(this,L,{writable:!0,value:void 0}),W(this,L,!0);var g;let y=(g=u?.target)!==null&&g!==void 0?g:o.currentTarget;const p=y?.getBoundingClientRect();let _,h=0,I,b=null;o.clientX!=null&&o.clientY!=null&&(I=o.clientX,b=o.clientY),p&&(I!=null&&b!=null?(_=I-p.left,h=b-p.top):(_=p.width/2,h=p.height/2)),this.type=s,this.pointerType=a,this.target=o.currentTarget,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.x=_,this.y=h}}const q=Symbol("linkClicked"),J="react-aria-pressable-style",Q="data-react-aria-pressable";function He(t){let{onPress:s,onPressChange:a,onPressStart:o,onPressEnd:u,onPressUp:g,onClick:y,isDisabled:p,isPressed:_,preventFocusOnPress:h,shouldCancelOnPointerExit:I,allowTextSelectionOnPress:b,ref:A,...se}=xe(t),[ie,X]=k.useState(!1),S=k.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:M,removeAllGlobalListeners:H}=$e(),C=m((e,i)=>{let c=S.current;if(p||c.didFirePressStart)return!1;let r=!0;if(c.isTriggeringEvent=!0,o){let l=new O("pressstart",i,e);o(l),r=l.shouldStopPropagation}return a&&a(!0),c.isTriggeringEvent=!1,c.didFirePressStart=!0,X(!0),r}),x=m((e,i,c=!0)=>{let r=S.current;if(!r.didFirePressStart)return!1;r.didFirePressStart=!1,r.isTriggeringEvent=!0;let l=!0;if(u){let n=new O("pressend",i,e);u(n),l=n.shouldStopPropagation}if(a&&a(!1),X(!1),s&&c&&!p){let n=new O("press",i,e);s(n),l&&(l=n.shouldStopPropagation)}return r.isTriggeringEvent=!1,l}),U=m((e,i)=>{let c=S.current;if(p)return!1;if(g){c.isTriggeringEvent=!0;let r=new O("pressup",i,e);return g(r),c.isTriggeringEvent=!1,r.shouldStopPropagation}return!0}),T=m(e=>{let i=S.current;if(i.isPressed&&i.target){i.didFirePressStart&&i.pointerType!=null&&x(E(i.target,e),i.pointerType,!1),i.isPressed=!1,i.isOverTarget=!1,i.activePointerId=null,i.pointerType=null,H(),b||N(i.target);for(let c of i.disposables)c();i.disposables=[]}}),G=m(e=>{I&&T(e)}),F=m(e=>{p||y?.(e)}),V=m((e,i)=>{if(!p&&y){let c=new MouseEvent("click",e);oe(c,i),y(le(c))}}),ae=k.useMemo(()=>{let e=S.current,i={onKeyDown(r){if(R(r.nativeEvent,r.currentTarget)&&$(r.currentTarget,v(r.nativeEvent))){var l;Z(v(r.nativeEvent),r.key)&&r.preventDefault();let n=!0;if(!e.isPressed&&!r.repeat){e.target=r.currentTarget,e.isPressed=!0,e.pointerType="keyboard",n=C(r,"keyboard");let f=r.currentTarget,d=P=>{R(P,f)&&!P.repeat&&$(f,v(P))&&e.target&&U(E(e.target,P),"keyboard")};M(w(r.currentTarget),"keyup",ve(d,c),!0)}n&&r.stopPropagation(),r.metaKey&&de()&&((l=e.metaKeyEvents)===null||l===void 0||l.set(r.key,r.nativeEvent))}else r.key==="Meta"&&(e.metaKeyEvents=new Map)},onClick(r){if(!(r&&!$(r.currentTarget,v(r.nativeEvent)))&&r&&r.button===0&&!e.isTriggeringEvent&&!j.isOpening){let l=!0;if(p&&r.preventDefault(),!e.ignoreEmulatedMouseEvents&&!e.isPressed&&(e.pointerType==="virtual"||be(r.nativeEvent))){let n=C(r,"virtual"),f=U(r,"virtual"),d=x(r,"virtual");F(r),l=n&&f&&d}else if(e.isPressed&&e.pointerType!=="keyboard"){let n=e.pointerType||r.nativeEvent.pointerType||"virtual",f=U(E(r.currentTarget,r),n),d=x(E(r.currentTarget,r),n,!0);l=f&&d,e.isOverTarget=!1,F(r),T(r)}e.ignoreEmulatedMouseEvents=!1,l&&r.stopPropagation()}}},c=r=>{var l;if(e.isPressed&&e.target&&R(r,e.target)){var n;Z(v(r),r.key)&&r.preventDefault();let d=v(r),P=$(e.target,v(r));x(E(e.target,r),"keyboard",P),P&&V(r,e.target),H(),r.key!=="Enter"&&B(e.target)&&$(e.target,d)&&!r[q]&&(r[q]=!0,j(e.target,r,!1)),e.isPressed=!1,(n=e.metaKeyEvents)===null||n===void 0||n.delete(r.key)}else if(r.key==="Meta"&&(!((l=e.metaKeyEvents)===null||l===void 0)&&l.size)){var f;let d=e.metaKeyEvents;e.metaKeyEvents=void 0;for(let P of d.values())(f=e.target)===null||f===void 0||f.dispatchEvent(new KeyboardEvent("keyup",P))}};if(typeof PointerEvent<"u"){i.onPointerDown=n=>{if(n.button!==0||!$(n.currentTarget,v(n.nativeEvent)))return;if(ye(n.nativeEvent)){e.pointerType="virtual";return}e.pointerType=n.pointerType;let f=!0;if(!e.isPressed){e.isPressed=!0,e.isOverTarget=!0,e.activePointerId=n.pointerId,e.target=n.currentTarget,b||me(e.target),f=C(n,e.pointerType);let d=v(n.nativeEvent);"releasePointerCapture"in d&&d.releasePointerCapture(n.pointerId),M(w(n.currentTarget),"pointerup",r,!1),M(w(n.currentTarget),"pointercancel",l,!1)}f&&n.stopPropagation()},i.onMouseDown=n=>{if($(n.currentTarget,v(n.nativeEvent))&&n.button===0){if(h){let f=fe(n.target);f&&e.disposables.push(f)}n.stopPropagation()}},i.onPointerUp=n=>{!$(n.currentTarget,v(n.nativeEvent))||e.pointerType==="virtual"||n.button===0&&!e.isPressed&&U(n,e.pointerType||n.pointerType)},i.onPointerEnter=n=>{n.pointerId===e.activePointerId&&e.target&&!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,C(E(e.target,n),e.pointerType))},i.onPointerLeave=n=>{n.pointerId===e.activePointerId&&e.target&&e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,x(E(e.target,n),e.pointerType,!1),G(n))};let r=n=>{if(n.pointerId===e.activePointerId&&e.isPressed&&n.button===0&&e.target){if($(e.target,v(n))&&e.pointerType!=null){let f=!1,d=setTimeout(()=>{e.isPressed&&e.target instanceof HTMLElement&&(f?T(n):(ue(e.target),e.target.click()))},80);M(n.currentTarget,"click",()=>f=!0,!0),e.disposables.push(()=>clearTimeout(d))}else T(n);e.isOverTarget=!1}},l=n=>{T(n)};i.onDragStart=n=>{$(n.currentTarget,v(n.nativeEvent))&&T(n)}}return i},[M,p,h,H,b,T,G,x,C,U,F,V]);return k.useEffect(()=>{if(!A)return;const e=w(A.current);if(!e||!e.head||e.getElementById(J))return;const i=e.createElement("style");i.id=J,i.textContent=`
@layer {
  [${Q}] {
    touch-action: pan-x pan-y pinch-zoom;
  }
}
    `.trim(),e.head.prepend(i)},[A]),k.useEffect(()=>{let e=S.current;return()=>{var i;b||N((i=e.target)!==null&&i!==void 0?i:void 0);for(let c of e.disposables)c();e.disposables=[]}},[b]),{isPressed:_||ie,pressProps:te(se,ae,{[Q]:!0})}}function B(t){return t.tagName==="A"&&t.hasAttribute("href")}function R(t,s){const{key:a,code:o}=t,u=s,g=u.getAttribute("role");return(a==="Enter"||a===" "||a==="Spacebar"||o==="Space")&&!(u instanceof z(u).HTMLInputElement&&!ne(u,a)||u instanceof z(u).HTMLTextAreaElement||u.isContentEditable)&&!((g==="link"||!g&&B(u))&&a!=="Enter")}function E(t,s){let a=s.clientX,o=s.clientY;return{currentTarget:t,shiftKey:s.shiftKey,ctrlKey:s.ctrlKey,metaKey:s.metaKey,altKey:s.altKey,clientX:a,clientY:o}}function ke(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!B(t)}function Z(t,s){return t instanceof HTMLInputElement?!ne(t,s):ke(t)}const we=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function ne(t,s){return t.type==="checkbox"||t.type==="radio"?s===" ":we.has(t.type)}export{He as $,Te as _,N as a,me as b};
