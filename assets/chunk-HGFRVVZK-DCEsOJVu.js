import{t as Ee,a as oe,b as Re}from"./chunk-WQVQ7P2I-CfgxybOt.js";import{$ as ye,p as re}from"./chunk-D2FF7S3A-BVqFDq1w.js";import{r as g,u as Te}from"./iframe-D8dPSlhY.js";import{m as S,o as Ae,c as V,d as A,j as $e}from"./index-9NAC_5dS.js";import{u as ke}from"./index-Ca3nUzO9.js";import{u as we}from"./index-DnQ1E3El.js";import{u as xe}from"./chunk-BDGLNRCW-VYLDRrAS.js";import{$ as De}from"./useOverlayTriggerState-B8a5Zest.js";import{$ as Se}from"./useFocusRing-vXsTo9u9.js";import{$ as Fe}from"./useOverlayTrigger-CfNb_J6i.js";import{$ as _e}from"./usePreventScroll-DeZ8mXPa.js";import{m as Le}from"./chunk-YFAKJTDR-_llI_GAI.js";var D=new WeakMap,i=[];function Me(a,r=document.body){let n=new Set(a),c=new Set,d=t=>{for(let l of t.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))n.add(l);let o=l=>{if(n.has(l)||l.parentElement&&c.has(l.parentElement)&&l.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let $ of n)if(l.contains($))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:o}),O=o(t);if(O===NodeFilter.FILTER_ACCEPT&&h(t),O!==NodeFilter.FILTER_REJECT){let l=e.nextNode();for(;l!=null;)h(l),l=e.nextNode()}},h=t=>{var o;let e=(o=D.get(t))!=null?o:0;t.getAttribute("aria-hidden")==="true"&&e===0||(e===0&&t.setAttribute("aria-hidden","true"),c.add(t),D.set(t,e+1))};i.length&&i[i.length-1].disconnect(),d(r);let f=new MutationObserver(t=>{for(let o of t)if(!(o.type!=="childList"||o.addedNodes.length===0)&&![...n,...c].some(e=>e.contains(o.target))){for(let e of o.removedNodes)e instanceof Element&&(n.delete(e),c.delete(e));for(let e of o.addedNodes)(e instanceof HTMLElement||e instanceof SVGElement)&&(e.dataset.liveAnnouncer==="true"||e.dataset.reactAriaTopLayer==="true")?n.add(e):e instanceof Element&&d(e)}});f.observe(r,{childList:!0,subtree:!0});let v={visibleNodes:n,hiddenNodes:c,observe(){f.observe(r,{childList:!0,subtree:!0})},disconnect(){f.disconnect()}};return i.push(v),()=>{f.disconnect();for(let t of c){let o=D.get(t);o!=null&&(o===1?(t.removeAttribute("aria-hidden"),D.delete(t)):D.set(t,o-1))}v===i[i.length-1]?(i.pop(),i.length&&i[i.length-1].observe()):i.splice(i.indexOf(v),1)}}function Ie(a){let r=i[i.length-1];if(r&&!r.visibleNodes.has(a))return r.visibleNodes.add(a),()=>{r.visibleNodes.delete(a)}}function Be(a,r){const{groupRef:n,triggerRef:c,popoverRef:d,showArrow:h,offset:f=7,crossOffset:v=0,scrollRef:t,shouldFlip:o,boundaryElement:e,isDismissable:O=!0,shouldCloseOnBlur:l=!0,shouldCloseOnScroll:$=!0,placement:F="top",containerPadding:W,shouldCloseOnInteractOutside:_,isNonModal:L,isKeyboardDismissDisabled:H,updatePositionDeps:k=[],...M}=a,C=L??!0,I=M.trigger==="SubmenuTrigger",{overlayProps:j,underlayProps:q}=we({isOpen:r.isOpen,onClose:r.close,shouldCloseOnBlur:l,isDismissable:O||I,isKeyboardDismissDisabled:H,shouldCloseOnInteractOutside:_||(E=>{var P;return!((P=c.current)!=null&&P.contains(E))}),disableOutsideEvents:!C},d),{overlayProps:m,arrowProps:J,placement:N,updatePosition:U,triggerAnchorPoint:G}=ye({...M,shouldFlip:o,crossOffset:v,targetRef:c,overlayRef:d,isOpen:r.isOpen,scrollRef:t,boundaryElement:e,containerPadding:W,placement:Ee(F),offset:h?f+3:f,onClose:C&&!I&&$?r.close:()=>{}});return ke(()=>{k.length&&U()},k),g.useEffect(()=>{var E,P;if(r.isOpen&&d.current)return C?Ie((E=n?.current)!=null?E:d.current):Me([(P=n?.current)!=null?P:d.current])},[C,r.isOpen,d,n]),{popoverProps:S(j,m),arrowProps:J,underlayProps:q,placement:N,triggerAnchorPoint:G}}var Ke="top";function Ze(a){var r,n,c;const d=Te(),[h,f]=Le(a,re.variantKeys),{as:v,ref:t,children:o,state:e,triggerRef:O,scrollRef:l,defaultOpen:$,onOpenChange:F,isOpen:W,isNonModal:_=!0,shouldFlip:L=!0,containerPadding:H=12,shouldBlockScroll:k=!1,isDismissable:M=!0,shouldCloseOnBlur:C,portalContainer:I,updatePositionDeps:j,dialogProps:q,placement:m=Ke,triggerType:J="dialog",showArrow:N=!1,offset:U=7,crossOffset:G=0,boundaryElement:E,isKeyboardDismissDisabled:P,shouldCloseOnInteractOutside:se,shouldCloseOnScroll:ne,triggerAnchorPoint:B,motionProps:ae,className:le,classNames:p,onClose:Q,...X}=h,ie=v||"div",z=xe(t),ce=g.useRef(null),K=g.useRef(!1),w=O||ce,de=(n=(r=a.disableAnimation)!=null?r:d?.disableAnimation)!=null?n:!1,ue=De({isOpen:W,defaultOpen:$,onOpenChange:s=>{F?.(s),s||Q?.()}}),u=e||ue,{popoverProps:Y,underlayProps:Z,placement:b}=Be({triggerRef:w,isNonModal:_,popoverRef:z,placement:m,offset:U,scrollRef:l,isDismissable:M,shouldCloseOnBlur:C,boundaryElement:E,crossOffset:G,shouldFlip:L,containerPadding:H,updatePositionDeps:j,isKeyboardDismissDisabled:P,shouldCloseOnScroll:ne,shouldCloseOnInteractOutside:se,triggerAnchorPoint:B},u),ee=g.useMemo(()=>b?Re(b,m)?b:m:null,[b,m]),{triggerProps:R}=Fe({type:J},u,w),{isFocusVisible:pe,isFocused:fe,focusProps:me}=Se(),y=g.useMemo(()=>re({...f}),[Ae(f)]),be=V(p?.base,le),ge={"--trigger-anchor-point":B?`${B.x}px ${B.y}px`:void 0};_e({isDisabled:!(k&&u.isOpen)});const ve=(s={})=>({ref:z,...S(Y,X,s),style:S(Y.style,X.style,s.style)}),Pe=(s={})=>({"data-slot":"base","data-open":A(u.isOpen),"data-focus":A(fe),"data-arrow":A(N),"data-focus-visible":A(pe),"data-placement":b?oe(b,m):void 0,...S(me,q,s),className:y.base({class:V(be)}),style:{outline:"none",...ge}}),he=g.useCallback((s={})=>({"data-slot":"content","data-open":A(u.isOpen),"data-arrow":A(N),"data-placement":b?oe(b,m):void 0,className:y.content({class:V(p?.content,s.className)})}),[y,u.isOpen,N,ee,m,p,b]),te=g.useCallback(s=>{var T;let x;return s.pointerType==="touch"&&(a?.backdrop==="blur"||a?.backdrop==="opaque")?x=setTimeout(()=>{K.current=!0},100):K.current=!0,(T=R.onPress)==null||T.call(R,s),()=>{clearTimeout(x)}},[R?.onPress]),Oe=g.useCallback((s={},T=null)=>{const{isDisabled:x,...Ne}=s;return{"data-slot":"trigger",...S({"aria-haspopup":"dialog"},R,Ne),onPress:te,isDisabled:x,className:y.trigger({class:V(p?.trigger,s.className),isTriggerDisabled:x}),ref:$e(T,w)}},[u,R,te,w]),Ce=g.useCallback((s={})=>({"data-slot":"backdrop",className:y.backdrop({class:p?.backdrop}),onClick:T=>{if(!K.current){T.preventDefault();return}u.close(),K.current=!1},...Z,...s}),[y,u.isOpen,p,Z]);return{state:u,Component:ie,children:o,classNames:p,showArrow:N,triggerRef:w,placement:ee,isNonModal:_,popoverRef:z,portalContainer:I,isOpen:u.isOpen,onClose:u.close,disableAnimation:de,shouldBlockScroll:k,backdrop:(c=a.backdrop)!=null?c:"transparent",motionProps:ae,getBackdropProps:Ce,getPopoverProps:ve,getTriggerProps:Oe,getDialogProps:Pe,getContentProps:he}}export{Ze as u};
