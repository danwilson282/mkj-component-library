import{d as o,a as $,e as y}from"./utils-U1MD0fLI.js";import{f as m,r as v,g as M,h as k}from"./iframe-D8dPSlhY.js";function H(e){return e.pointerType===""&&e.isTrusted?!0:m()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function P(e){return!m()&&e.width===0&&e.height===0||e.width===1&&e.height===1&&e.pressure===0&&e.detail===0&&e.pointerType==="mouse"}let a=null,c=new Set,i=new Map,f=!1,E=!1;const I={Tab:!0,Escape:!0};function b(e,n){for(let t of c)t(e,n)}function K(e){return!(e.metaKey||!k()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function u(e){f=!0,K(e)&&(a="keyboard",b("keyboard",e))}function d(e){a="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(f=!0,b("pointer",e))}function L(e){H(e)&&(f=!0,a="virtual")}function w(e){e.target===window||e.target===document||y||!e.isTrusted||(!f&&!E&&(a="virtual",b("virtual",e)),f=!1,E=!1)}function T(){y||(f=!1,E=!0)}function s(e){if(typeof window>"u"||typeof document>"u"||i.get(o(e)))return;const n=o(e),t=$(e);let r=n.HTMLElement.prototype.focus;n.HTMLElement.prototype.focus=function(){f=!0,r.apply(this,arguments)},t.addEventListener("keydown",u,!0),t.addEventListener("keyup",u,!0),t.addEventListener("click",L,!0),n.addEventListener("focus",w,!0),n.addEventListener("blur",T,!1),typeof PointerEvent<"u"&&(t.addEventListener("pointerdown",d,!0),t.addEventListener("pointermove",d,!0),t.addEventListener("pointerup",d,!0)),n.addEventListener("beforeunload",()=>{h(e)},{once:!0}),i.set(n,{focus:r})}const h=(e,n)=>{const t=o(e),r=$(e);n&&r.removeEventListener("DOMContentLoaded",n),i.has(t)&&(t.HTMLElement.prototype.focus=i.get(t).focus,r.removeEventListener("keydown",u,!0),r.removeEventListener("keyup",u,!0),r.removeEventListener("click",L,!0),t.removeEventListener("focus",w,!0),t.removeEventListener("blur",T,!1),typeof PointerEvent<"u"&&(r.removeEventListener("pointerdown",d,!0),r.removeEventListener("pointermove",d,!0),r.removeEventListener("pointerup",d,!0)),i.delete(t))};function O(e){const n=$(e);let t;return n.readyState!=="loading"?s(e):(t=()=>{s(e)},n.addEventListener("DOMContentLoaded",t)),()=>h(e,t)}typeof document<"u"&&O();function S(){return a!=="pointer"}function A(){return a}function D(e){a=e,b(e,null)}function W(){s();let[e,n]=v.useState(a);return v.useEffect(()=>{let t=()=>{n(a)};return c.add(t),()=>{c.delete(t)}},[]),M()?null:e}const C=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function F(e,n,t){let r=$(t?.target);const l=typeof window<"u"?o(t?.target).HTMLInputElement:HTMLInputElement,p=typeof window<"u"?o(t?.target).HTMLTextAreaElement:HTMLTextAreaElement,g=typeof window<"u"?o(t?.target).HTMLElement:HTMLElement,x=typeof window<"u"?o(t?.target).KeyboardEvent:KeyboardEvent;return e=e||r.activeElement instanceof l&&!C.has(r.activeElement.type)||r.activeElement instanceof p||r.activeElement instanceof g&&r.activeElement.isContentEditable,!(e&&n==="keyboard"&&t instanceof x&&!I[t.key])}function _(e,n,t){s(),v.useEffect(()=>{let r=(l,p)=>{F(!!t?.isTextInput,l,p)&&e(S())};return c.add(r),()=>{c.delete(r)}},n)}export{S as $,_ as a,P as b,H as c,A as d,D as e,W as f};
